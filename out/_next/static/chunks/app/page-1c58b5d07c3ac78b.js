(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{915:function(e,t,n){Promise.resolve().then(n.bind(n,5273))},7111:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(7437),a=n(2265);function i(e){let{label:t,service:n}=e,[i,o]=(0,a.useState)(!1),[l,s]=(0,a.useState)(!1);(0,a.useEffect)(()=>{o(!0)},[]);let c=async()=>{if(!l&&i){s(!0);try{let e="queue_last_".concat(n),t=parseInt(localStorage.getItem(e)||"0",10)+1;localStorage.setItem(e,String(t));let r="".concat(n).concat(String(t).padStart(3,"0")),a=JSON.parse(localStorage.getItem("queue_history")||"[]");if(a.push({code:r,service:n,ts:Date.now()}),localStorage.setItem("queue_history",JSON.stringify(a)),window.dispatchEvent(new Event("storage")),window.electronAPI)try{let e=await window.electronAPI.printThermal({queueCode:r,service:"Layanan ".concat(n),printerName:""});e.success?console.log("✅ Print berhasil!"):(console.error("❌ Print gagal:",e.error),alert("⚠️ Gagal print: "+e.error))}catch(e){console.error("Print error:",e),alert("⚠️ Error print: "+e.message)}alert("✅ Nomor antrian Anda:\n\n".concat(r,"\n\nLayanan ").concat(n))}catch(e){console.error(e),alert("Terjadi kesalahan: "+e.message)}finally{s(!1)}}};return(0,r.jsx)("button",{onClick:c,disabled:l,style:{width:"100%",padding:"16px 24px",background:l?"#9ca3af":"#2563eb",color:"white",border:"none",borderRadius:"12px",fontSize:"18px",fontWeight:600,cursor:l?"not-allowed":"pointer",transition:"all 0.2s"},children:l?"⏳ Memproses...":t})}},6164:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(7437),a=n(2265),i=n(1379);function o(e){let{service:t}=e,[n,o]=(0,a.useState)(!1),[l,s]=(0,a.useState)(0),[c,d]=(0,a.useState)("-"),[u,g]=(0,a.useState)([]),[p,h]=(0,a.useState)(""),m=()=>{let e=JSON.parse(localStorage.getItem("queue_history")||"[]"),n=JSON.parse(localStorage.getItem("queue_called")||"[]"),r=new Set(n.map(e=>e.code));s(e.filter(e=>e.service===t&&!r.has(e.code)).length);let a=n.filter(e=>e.service===t).slice(-1)[0];d(a?a.code:"-")};(0,a.useEffect)(()=>(o(!0),m(),window.electronAPI&&window.electronAPI.getPrinters().then(e=>{let t=e.filter(e=>0===e.status||void 0===e.status||!e.status);g(t);let n=t.find(e=>e.isDefault);n?h(n.name):t.length>0&&h(t[0].name)}).catch(e=>{console.error("Error loading printers:",e)}),window.addEventListener("storage",m),window.addEventListener(i.m,m),()=>{window.removeEventListener("storage",m),window.removeEventListener(i.m,m)}),[t]);let x=async()=>{if(!window.electronAPI)return alert("Fitur print hanya tersedia di aplikasi desktop");let e=JSON.parse(localStorage.getItem("queue_history")||"[]"),n=new Set(JSON.parse(localStorage.getItem("queue_called")||"[]").map(e=>e.code)),r=e.filter(e=>e.service===t&&!n.has(e.code));if(!r.length)return alert("Tidak ada antrian untuk ".concat(t));let a=r[0];if(!p)return alert("⚠️ Pilih printer thermal terlebih dahulu!\n\nPastikan printer sudah terhubung dan terdeteksi di dropdown.");try{let e=await window.electronAPI.printThermal({queueCode:a.code,service:t,printerName:p});e.success?alert("✅ Tiket ".concat(a.code," berhasil dicetak ke printer:\n").concat(p)):alert("❌ Gagal print ke ".concat(p,":\n").concat(e.error))}catch(e){alert("❌ Error saat print: ".concat(e.message))}};return n?(0,r.jsxs)("div",{className:"service-card",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{style:{fontWeight:700},children:["Layanan ",t]}),(0,r.jsxs)("div",{style:{marginTop:6,fontSize:20,color:"#334155"},children:["Terakhir dipanggil: ",(0,r.jsx)("strong",{children:c})]}),(0,r.jsxs)("div",{style:{marginTop:8,color:"#64748b"},children:["Menunggu: ",l]}),u.length>0?(0,r.jsxs)("div",{style:{marginTop:12},children:[(0,r.jsxs)("label",{style:{fontSize:13,color:"#64748b",display:"block",marginBottom:4},children:["Printer Thermal (",u.length," terdeteksi):"]}),(0,r.jsxs)("select",{value:p,onChange:e=>h(e.target.value),style:{padding:"6px 10px",borderRadius:6,border:"1px solid #cbd5e1",fontSize:14,width:"100%"},children:[(0,r.jsx)("option",{value:"",children:"-- Pilih Printer --"}),u.map(e=>(0,r.jsxs)("option",{value:e.name,children:[e.name," ",e.isDefault?"⭐ (Default)":""]},e.name))]})]}):(0,r.jsx)("div",{style:{marginTop:12,padding:"8px 12px",background:"#fef3c7",borderRadius:6,fontSize:13,color:"#92400e"},children:"⚠️ Tidak ada printer terdeteksi. Pastikan printer sudah terhubung."})]}),(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[(0,r.jsx)("button",{onClick:()=>{let e=JSON.parse(localStorage.getItem("queue_history")||"[]"),n=JSON.parse(localStorage.getItem("queue_called")||"[]"),r=new Set(n.map(e=>e.code)),a=e.filter(e=>e.service===t&&!r.has(e.code));if(!a.length)return alert("Tidak ada antrian untuk ".concat(t));let o=a[0];n.push({...o,ts:Date.now()}),localStorage.setItem("queue_called",JSON.stringify(n)),localStorage.setItem("queue_current",o.code),(0,i.L)(),alert("Memanggil ".concat(o.code))},className:"btn btn-green",children:"Panggil Berikutnya"}),u.length>0&&(0,r.jsx)("button",{onClick:x,className:"btn",style:{background:"#8b5cf6",color:"white"},children:"\uD83D\uDDA8️ Print Thermal"})]})]}):(0,r.jsx)("div",{className:"service-card",children:"Loading..."})}},1379:function(e,t,n){"use strict";n.d(t,{L:function(){return a},m:function(){return r}});let r="queue-updated";function a(){window.dispatchEvent(new Event(r))}},5273:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return s}});var r=n(7437),a=n(2265),i=n(7111),o=n(6164),l=n(1379);function s(){let[e,t]=(0,a.useState)(!1),[n,s]=(0,a.useState)("pelanggan"),[c,d]=(0,a.useState)("-"),u=(0,a.useRef)(null);(0,a.useEffect)(()=>{t(!0)},[]);let g=e=>{if("speechSynthesis"in window){let t=new SpeechSynthesisUtterance(e);t.lang="id-ID",t.pitch=1,t.rate=.9;let n=window.speechSynthesis.getVoices(),r=n.find(e=>e.lang.toLowerCase().includes("id")),a=n.find(e=>["female","woman","google","microsoft"].some(t=>e.name.toLowerCase().includes(t))&&e.lang.toLowerCase().includes("id"));a&&(r=a),r&&(t.voice=r),window.speechSynthesis.cancel(),window.speechSynthesis.speak(t)}},p=()=>{let e=localStorage.getItem("queue_current")||"-";e!==c&&"-"!==e&&(u.current&&(u.current.currentTime=0,u.current.play()),setTimeout(()=>{g("Nomor antrian ".concat(e,". Dipersilakan menuju loket"))},1200)),d(e)};(0,a.useEffect)(()=>{if("display"===n)return p(),window.addEventListener("storage",p),window.addEventListener(l.m,p),window.speechSynthesis.onvoiceschanged=()=>{},()=>{window.removeEventListener("storage",p),window.removeEventListener(l.m,p)}},[n,c]);let h=e=>({padding:"12px 24px",background:e?"#2563eb":"#e5e7eb",color:e?"white":"#374151",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:600,fontSize:"14px",transition:"all 0.2s"});return e?(0,r.jsxs)("div",{style:{textAlign:"center",marginTop:"20px"},children:[(0,r.jsx)("h1",{style:{fontSize:"42px",margin:0,color:"#2563eb",fontWeight:800},children:"Sistem Antrian"}),(0,r.jsx)("p",{style:{color:"#6b7280",marginTop:"8px",marginBottom:"24px"},children:"Sistem Manajemen Antrian"}),(0,r.jsxs)("div",{style:{display:"flex",gap:"12px",justifyContent:"center",marginBottom:"28px"},children:[(0,r.jsx)("button",{onClick:()=>s("pelanggan"),style:h("pelanggan"===n),children:"\uD83D\uDC64 Pelanggan"}),(0,r.jsx)("button",{onClick:()=>s("petugas"),style:h("petugas"===n),children:"\uD83D\uDCBC Petugas"}),(0,r.jsx)("button",{onClick:()=>s("display"),style:h("display"===n),children:"\uD83D\uDCFA Display"})]}),"pelanggan"===n&&(0,r.jsxs)("div",{style:{maxWidth:"760px",margin:"0 auto",background:"rgba(255,255,255,0.85)",backdropFilter:"blur(6px)",padding:"28px",borderRadius:"20px",boxShadow:"0 12px 30px rgba(2,6,23,0.06)",border:"1px solid rgba(255,255,255,0.6)"},children:[(0,r.jsx)("h2",{style:{fontSize:"28px",margin:"0 0 6px 0",color:"#0f172a"},children:"Ambil Nomor Antrian"}),(0,r.jsx)("p",{style:{color:"#6b7280"},children:"Pilih layanan yang Anda butuhkan"}),(0,r.jsx)("div",{style:{marginTop:20,display:"grid",gap:12},children:[{key:"A",label:"Layanan A"}].map(e=>(0,r.jsx)(i.Z,{label:e.label,service:e.key},e.key))})]}),"petugas"===n&&(0,r.jsxs)("div",{style:{maxWidth:"760px",margin:"0 auto",background:"rgba(255,255,255,0.85)",backdropFilter:"blur(6px)",padding:"28px",borderRadius:"20px",boxShadow:"0 12px 30px rgba(2,6,23,0.06)",border:"1px solid rgba(255,255,255,0.6)"},children:[(0,r.jsx)("h2",{style:{fontSize:"28px",margin:"0 0 6px 0",color:"#064e3b"},children:"Panel Petugas"}),(0,r.jsx)("p",{style:{color:"#6b7280"},children:"Kelola dan panggil nomor antrian"}),(0,r.jsx)("button",{onClick:()=>{localStorage.removeItem("queue_last_A"),localStorage.removeItem("queue_current"),localStorage.removeItem("queue_history"),localStorage.removeItem("queue_called"),(0,l.L)(),alert("Semua antrian berhasil direset.")},style:{marginTop:15,marginBottom:20,padding:"10px 16px",background:"#ef4444",color:"white",borderRadius:"8px",border:"none",cursor:"pointer",fontWeight:600},children:"\uD83D\uDD04 Reset Semua Antrian"}),(0,r.jsx)("div",{style:{marginTop:18,display:"grid",gap:12},children:(0,r.jsx)(o.Z,{service:"A"})})]}),"display"===n&&(0,r.jsxs)("div",{style:{textAlign:"center",padding:"40px",borderRadius:"18px",background:"white",maxWidth:"760px",margin:"0 auto"},children:[(0,r.jsx)("audio",{src:"/sounds/dingdong.mp3",ref:u}),(0,r.jsx)("h2",{style:{fontSize:"28px",margin:"0 0 6px 0",color:"#5b21b6"},children:"Nomor Antrian"}),(0,r.jsx)("div",{style:{fontSize:"56px",fontWeight:800,color:"#2563eb",margin:"20px 0"},children:c}),(0,r.jsx)("p",{style:{color:"#6b7280",marginTop:12},children:"Silakan menuju loket"})]})]}):(0,r.jsx)("div",{style:{textAlign:"center",padding:"40px"},children:"Loading..."})}}},function(e){e.O(0,[971,23,744],function(){return e(e.s=915)}),_N_E=e.O()}]);